#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ–∂–∏–º–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ GPS –≤—Ä–µ–º–µ–Ω–∏
"""

import numpy as np

def test_gps_normalization():
    """–¢–µ—Å—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ GPS –≤—Ä–µ–º–µ–Ω–∏"""
    print("üß™ –¢–ï–°–¢ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò GPS –í–†–ï–ú–ï–ù–ò")
    print("=" * 60)
    
    # –¢–µ—Å—Ç 1: –ë–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (Unix timestamp)
    print("\n1. –¢–µ—Å—Ç Unix timestamp:")
    gps_time_array = np.array([1728312456.123, 1728312476.456, 1728312496.789])
    print(f"   –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: {np.min(gps_time_array):.3f} - {np.max(gps_time_array):.3f}")
    
    if np.min(gps_time_array) > 100:
        min_gps_time = np.min(gps_time_array)
        gps_time_array = gps_time_array - min_gps_time
        print(f"   ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 0.0 - {np.max(gps_time_array):.3f}")
        print(f"   ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {np.max(gps_time_array):.2f} —Å–µ–∫—É–Ω–¥")
    
    # –¢–µ—Å—Ç 2: –ó–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–∞–∑—É–º–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
    print("\n2. –¢–µ—Å—Ç —Ä–∞–∑—É–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:")
    gps_time_array = np.array([0.0, 10.5, 20.8, 30.2])
    print(f"   –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: {np.min(gps_time_array):.3f} - {np.max(gps_time_array):.3f}")
    
    if np.min(gps_time_array) > 100:
        print(f"   ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è")
    else:
        print(f"   ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –≤ –Ω–æ—Ä–º–µ (0-100), –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞")
    
    # –¢–µ—Å—Ç 3: –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Ç—Ä–µ–±—É—é—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏)
    print("\n3. –¢–µ—Å—Ç —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π:")
    gps_time_array = np.array([150.0, 175.5, 200.3])
    print(f"   –ò—Å—Ö–æ–¥–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: {np.min(gps_time_array):.3f} - {np.max(gps_time_array):.3f}")
    
    if np.min(gps_time_array) > 100:
        min_gps_time = np.min(gps_time_array)
        gps_time_array = gps_time_array - min_gps_time
        print(f"   ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: 0.0 - {np.max(gps_time_array):.3f}")
    
    print("\n‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!")

def test_express_mode_logic():
    """–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ —ç–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ–∂–∏–º–∞"""
    print("\nüß™ –¢–ï–°–¢ –õ–û–ì–ò–ö–ò –≠–ö–°–ü–†–ï–°–°-–†–ï–ñ–ò–ú–ê")
    print("=" * 60)
    
    # –°–∏–º—É–ª—è—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–ø–∏–∫–æ–≤
    available_pc_topics = {
        "/cloud_registered": 1000,
        "/velodyne_points": 500
    }
    
    available_odom_topics = {
        "/lio/odom": 1000,
        "/odom": 500
    }
    
    print("\n1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ø–∏–∫–∞ –æ–±–ª–∞–∫–∞ —Ç–æ—á–µ–∫:")
    if "/cloud_registered" in available_pc_topics:
        print("   ‚úÖ /cloud_registered –Ω–∞–π–¥–µ–Ω")
        print("   ‚úÖ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏")
    else:
        print("   ‚ùå /cloud_registered –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚ÑπÔ∏è  –ë—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä")
    
    print("\n2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ø–∏–∫–∞ –æ–¥–æ–º–µ—Ç—Ä–∏–∏:")
    if "/lio/odom" in available_odom_topics:
        print("   ‚úÖ /lio/odom –Ω–∞–π–¥–µ–Ω")
        print("   ‚úÖ –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏")
    else:
        print("   ‚ùå /lio/odom –Ω–µ –Ω–∞–π–¥–µ–Ω")
        print("   ‚ÑπÔ∏è  –ë—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω —Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä")
    
    print("\n3. –†–µ–∂–∏–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏:")
    transform_mode = "none"
    print(f"   ‚úÖ –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: {transform_mode}")
    print("   ‚ÑπÔ∏è  /cloud_registered —É–∂–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö")
    
    print("\n‚úÖ –õ–æ–≥–∏–∫–∞ —ç–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ–∂–∏–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞!")

if __name__ == "__main__":
    print("üöÄ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–û–í–´–• –§–£–ù–ö–¶–ò–ô")
    print("=" * 80)
    
    test_gps_normalization()
    test_express_mode_logic()
    
    print("\n" + "=" * 80)
    print("‚úÖ –í–°–ï –¢–ï–°–¢–´ –£–°–ü–ï–®–ù–û –ü–†–û–ô–î–ï–ù–´!")
    print("=" * 80)
    
    print("\nüìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:")
    print("1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø—Ä–µ—Å—Å-—Ä–µ–∂–∏–º –¥–ª—è LIO-SAM –¥–∞–Ω–Ω—ã—Ö")
    print("2. GPS –≤—Ä–µ–º—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è (> 100 -> 0)")
    print("3. –î–ª—è /cloud_registered –Ω–µ –Ω—É–∂–Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è")
    print("4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ GPS –≤—Ä–µ–º—è –≤ –≤—ã—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0-XXX)")
