# –ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª –∏–∑ Git

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–§–∞–π–ª `test.bag` (~1.1 –ì–ë) –±—ã–ª —Å–ª—É—á–∞–π–Ω–æ –∑–∞–∫–æ–º–º–∏—á–µ–Ω –∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª—ë–Ω –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ git.

## üîß –®–∞–≥–∏ –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
```bash
git branch backup-before-cleanup
```

### 2. –°–±—Ä–æ—Å –∫–æ–º–º–∏—Ç–æ–≤ (—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π)
```bash
git reset --soft origin/main
```

–≠—Ç–æ –æ—Ç–∫–∞—Ç–∏–ª–æ 3 –∫–æ–º–º–∏—Ç–∞, –Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω–¥–µ–∫—Å–µ.

### 3. –£–¥–∞–ª–µ–Ω–∏–µ test.bag –∏–∑ –∏–Ω–¥–µ–∫—Å–∞
```bash
git reset HEAD test.bag
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .gitignore
–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤:
```gitignore
# ROS bag files (—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –¥–ª—è git)
*.bag
test.bag

# Test output files
test_camera_positions.*
camera_debug_test.json
*.backup
```

### 5. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ (–±–µ–∑ test.bag)
```bash
git add .gitignore camera_frames_debug.py extract_camera_positions.py doc/
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–æ –ü–û –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –∫–∞–º–µ—Ä—ã –∏–∑ ROS bag"
```

### 6. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ git
```bash
git reflog expire --expire=now --all
git gc --prune=now --aggressive
```

–≠—Ç–æ —É–¥–∞–ª—è–µ—Ç test.bag –∏–∑ –≤—Å–µ—Ö —Å—Ç–∞—Ä—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ git –∏ —Å–∂–∏–º–∞–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ:**
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∞–ª–∞ test.bag (~1.1 –ì–ë)
- –†–∞–∑–º–µ—Ä .git: ~433 –ú–ë
- 3 –∫–æ–º–º–∏—Ç–∞ —Å –ª–∏—à–Ω–∏–º —Ñ–∞–π–ª–æ–º

**–ü–æ—Å–ª–µ:**
- test.bag —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–∏—Å–∫–µ (–Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è)
- –ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞
- –ù–æ–≤—ã–π —á–∏—Å—Ç—ã–π –∫–æ–º–º–∏—Ç –±–µ–∑ –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞
- –†–∞–∑–º–µ—Ä .git –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ (–ø–æ—Å–ª–µ gc)

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```bash
# –û–±—ã—á–Ω—ã–π push (–∏—Å—Ç–æ—Ä–∏—è –Ω–µ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
git push origin main

# –ò–õ–ò –µ—Å–ª–∏ —É–∂–µ –ø—É—à–∏–ª–∏ —Å—Ç–∞—Ä—ã–µ –∫–æ–º–º–∏—Ç—ã - force push
# ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: —ç—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!
git push origin main --force
```

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
git reset --hard backup-before-cleanup

# –£–¥–∞–ª–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –≤–µ—Ç–∫—É –∫–æ–≥–¥–∞ –≤—Å—ë –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
git branch -d backup-before-cleanup
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å .gitignore –∑–∞—Ä–∞–Ω–µ–µ
–î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore` –î–û —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏:
```gitignore
*.bag
*.rosbag
*.db3
*.mcap
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Git LFS –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –≤ git:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Git LFS
brew install git-lfs  # macOS
# –∏–ª–∏: apt install git-lfs  # Linux

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
git lfs install

# –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
git lfs track "*.bag"
git add .gitattributes
```

### 3. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–∫–æ–º–º–∏—á–µ–Ω–æ
git status

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤
git ls-files | xargs ls -lh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–æ–º–º–∏—Ç–∞
git diff --cached --stat
```

## üõ†Ô∏è –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### –ú–µ—Ç–æ–¥ 1: BFG Repo-Cleaner (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å BFG
brew install bfg  # macOS

# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
bfg --delete-files test.bag
git reflog expire --expire=now --all
git gc --prune=now --aggressive
```

### –ú–µ—Ç–æ–¥ 2: git filter-repo (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
pip install git-filter-repo

# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª
git filter-repo --path test.bag --invert-paths

# –û—á–∏—Å—Ç–∫–∞
git gc --prune=now --aggressive
```

### –ú–µ—Ç–æ–¥ 3: Interactive Rebase (–¥–ª—è –Ω–µ–¥–∞–≤–Ω–∏—Ö –∫–æ–º–º–∏—Ç–æ–≤)
```bash
# –ù–∞—á–∞—Ç—å rebase
git rebase -i HEAD~3

# –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∏–∑–º–µ–Ω–∏—Ç—å 'pick' –Ω–∞ 'edit' –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞
# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª
git rm --cached test.bag
git commit --amend
git rebase --continue
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Force push –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é** - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–π—Ç–µ—Å—å —Å –∫–æ–º–∞–Ω–¥–æ–π
2. **–õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞** - test.bag –æ—Å—Ç–∞–ª—Å—è –Ω–∞ –¥–∏—Å–∫–µ
3. **–ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–Ω** - –≤–µ—Ç–∫–∞ `backup-before-cleanup` –¥–ª—è –æ—Ç–∫–∞—Ç–∞
4. **Git gc –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è** - –æ—Å–æ–±–µ–Ω–Ω–æ —Å `--aggressive`

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏
git rev-list --objects --all | \
  git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' | \
  awk '/^blob/ {print substr($0,6)}' | \
  sort --numeric-sort --key=2 | \
  tail -10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
du -sh .git

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
git status --ignored

# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –∏–Ω–¥–µ–∫—Å–∞ –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –¥–∏—Å–∫–µ
git rm --cached <file>
```

---

**–°–æ–∑–¥–∞–Ω–æ:** 11 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** rosbag_to_las
